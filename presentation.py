from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN

# Создаем презентацию
prs = Presentation()


# Функция для создания слайда с заголовком и текстом
def add_slide(prs, title_text, content_text):
    slide_layout = prs.slide_layouts[1]  # 1 - это макет "Заголовок и объект"
    slide = prs.slides.add_slide(slide_layout)

    # Заголовок
    title = slide.shapes.title
    title.text = title_text

    # Текст (Body)
    body_shape = slide.placeholders[1]
    tf = body_shape.text_frame
    tf.text = content_text[0]  # Первый пункт

    # Остальные пункты
    for item in content_text[1:]:
        p = tf.add_paragraph()
        p.text = item
        p.level = 0

    return slide


# Функция для титульного слайда
def add_title_slide(prs, title_text, subtitle_text):
    slide_layout = prs.slide_layouts[0]  # 0 - Титульный
    slide = prs.slides.add_slide(slide_layout)
    title = slide.shapes.title
    subtitle = slide.placeholders[1]
    title.text = title_text
    subtitle.text = subtitle_text


# --- 1. Титульный слайд ---
add_title_slide(prs,
                "Інтелектуальна підсистема координації\nпересування роєм для дронів",
                "Виконав: Студент групи [ВАША ГРУПА]\nКерівник: [ПІБ ВИКЛАДАЧА]"
                )

# --- 2. Задача та Мотивація ---
add_slide(prs, "Задача та Мотивація", [
    "Моделювання колективної поведінки: Дослідження алгоритмів, що дозволяють групі агентів діяти як єдиний організм.",
    "Децентралізація управління: Відмова від ручного керування кожним дроном на користь локальних правил.",
    "Масштабованість: Забезпечення стабільної роботи алгоритму для 50+ агентів.",
    "Практичне застосування: Рятувальні операції, агромоніторинг, шоу дронів."
])

# --- 3. Технології ---
add_slide(prs, "Обрані технології та інструменти", [
    "Мова: Python 3.x + PyGame (для візуалізації 60 FPS).",
    "Архітектура: Об'єктно-орієнтований підхід (класи Drone, SwarmSystem).",
    "Математика: Власна реалізація векторної алгебри (клас Vector) без важких бібліотек типу NumPy.",
    "Гнучкість: Можливість налаштування вагових коефіцієнтів у реальному часі."
])

# --- 4. Алгоритм Boids ---
add_slide(prs, "Алгоритмічна основа (Boids)", [
    "Базується на 3 правилах Крейга Рейнольдса:",
    "1. Separation (Розділення): Уникнення зіткнень із сусідами.",
    "2. Alignment (Вирівнювання): Синхронізація напрямку з групою.",
    "3. Cohesion (Згуртованість): Прагнення до центру мас групи.",
    "+ Target Seeking: Глобальна сила тяжіння до цілі."
])

# --- 5. Програмна реалізація ---
add_slide(prs, "Програмна реалізація (SwarmSystem)", [
    "Neighbor Detection: Оптимізований пошук сусідів у радіусі видимості.",
    "Vector Accumulation: Підсумовування векторів сил з урахуванням пріоритетів.",
    "State Machine: Гібридний автомат перемикання станів (Політ / Паркування).",
    "Код повністю модульний та розширюваний."
])

# --- 6. Архітектура взаємодії ---
add_slide(prs, "Архітектура взаємодії", [
    "1. User Input: Отримання координат цілі (миша).",
    "2. Swarm Controller: Розрахунок дистанцій та станів.",
    "3. Agent (Drone): Застосування сил (F=ma) та оновлення фізики.",
    "4. Render: Відмальовка сцени."
])

# --- 7. Експериментальне дослідження ---
add_slide(prs, "Проблема та Рішення", [
    "Проблема: При класичному алгоритмі дрони пролітали ціль за інерцією (осциляція).",
    "Рішення: Впровадження механізму Arrival Behavior.",
    "- В радіусі SLOWING_RADIUS швидкість лінійно згасає.",
    "- В радіусі PARKING_RADIUS вмикається посилене тертя (Friction 0.85).",
    "Результат: Дрони плавно зупиняються без накладання."
])

# --- 8. Результати ---
add_slide(prs, "Результати роботи", [
    "Реалізовані сценарії:",
    "- Вільний організований політ за ціллю.",
    "- Автоматичне уникнення колізій.",
    "- Динамічне перешикування при зміні курсу.",
    "- Стабільна робота системи (60 FPS) при 50 агентах."
])

# --- 9. Висновки ---
add_slide(prs, "Висновки", [
    "Розроблено стабільну підсистему ройового інтелекту.",
    "Реалізовано гібридну модель поведінки (Flight/Parking).",
    "Досягнуто емерджентної поведінки (складна координація з простих правил).",
    "Система готова до інтеграції в реальні роботизовані платформи."
])

# --- 10. Фінал ---
add_slide(prs, "Дякую за увагу!", [
    "Питання?",
    "",
    "[Ваше Ім'я]",
    "[Ваш Email/Контакт]"
])

# Сохранение
filename = "DroneSwarm_Presentation.pptx"
prs.save(filename)
print(f"Презентація збережена як {filename}")